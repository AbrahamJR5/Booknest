<div class="container py-5">
  <h2 class="fw-bold text-dark-custom mb-4">Mis Reservaciones</h2>

  @if (cargando) {
    <div class="text-center py-5">
      <div class="spinner-border text-primary" role="status"></div>
      <p class="mt-2 text-muted">Cargando tus reservas...</p>
    </div>
  } @else {

    @if (misReservas.length > 0) {
      <div class="row g-4">
        @for (reserva of misReservas; track reserva.id_reservacion) {
          <div class="col-md-6 col-lg-4">
            <div class="card border-0 shadow-sm h-100">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-start mb-3">
                  <h5 class="card-title fw-bold text-primary-custom mb-0">
                    <i class="bi bi-book me-2"></i>{{ reserva.titulo_libro }}
                  </h5>
                  <span class="badge rounded-pill"
                        [ngClass]="{
                          'bg-warning text-dark': reserva.estado === 'pendiente',
                          'bg-success': reserva.estado === 'recogido',
                          'bg-danger': reserva.estado === 'cancelado'
                        }">
                    {{ reserva.estado | titlecase }}
                  </span>
                </div>

                <p class="card-text text-muted small">
                  <strong>ID Reserva:</strong> #{{ reserva.id_reservacion }}
                </p>

                <div class="alert alert-light border d-flex align-items-center" role="alert">
                  <i class="bi bi-calendar-event fs-4 me-3 text-secondary"></i>
                  <div>
                    <small class="d-block text-muted">Fecha Límite:</small>
                    <strong>{{ reserva.fecha_limite | date:'fullDate' }}</strong>
                  </div>
                </div>

                @if (reserva.estado === 'pendiente') {
                  <button class="btn btn-outline-danger w-100 btn-sm mt-2"
                          (click)="cancelar(reserva.id_reservacion)">
                    <i class="bi bi-x-circle me-1"></i> Cancelar Reserva
                  </button>
                }
              </div>
            </div>
          </div>
        }
      </div>
    } @else {
      <div class="text-center py-5 bg-light rounded-3">
        <i class="bi bi-bookmark-x fs-1 text-muted"></i>
        <h4 class="mt-3">Aún no tienes reservas</h4>
        <p class="text-muted">¡Explora nuestro catálogo y encuentra tu próxima lectura!</p>
        <a routerLink="/catalogo" class="btn btn-primary-custom mt-2">Ir al Catálogo</a>
      </div>
    }

  }
</div>
